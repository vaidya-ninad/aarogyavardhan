<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Differentiator</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
</head>

<body>
    <h1 style="text-align: center; margin: 20px">Differentiator</h1>
    <h2 style="text-align: center; margin: 30px">Assesment of Acute URTI</h2>
    <form id='assessment-form' method="POST" data-netlify="true">
        <div class="container border rounded">
            <div class="form-group">
                <label for="consultant-name">Name of the Consultant</label>
                <input type="text" name="consultant-name" class="form-control" required>
                <label for="name">Name of the Patient</label>
                <input type="text" name="name" class="form-control" required>
                <label for="mb-no">Mobile number of the Patient</label>
                <input type="text" name="mb-no" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="age-group-select">Select Age Group</label>
                <select name="age-group-select" class="form-control" id="age-group-select">
                    <option value="1">3 to 14</option>
                    <option value="0">15 to 44</option>
                    <option value="-1">Above 45</option>
                </select>
            </div>
            <div class="form-group">
                <label>Cough?</label>
                <select name="cough-category" for="cough-category" class="form-control" id="cough-category">
                    <option value="1">No</option>
                    <option value="0">Yes</option>
                </select>
            </div>
            <div class="form-group">
                <label for="stuffy-nose-category">Stuffy Nose?</label>
                <select name="stuffy-nose-category" class="form-control" id="stuffy-nose-category">
                    <option value="0">No</option>
                    <option value="1">Yes</option>
                </select>
            </div>
            <div class="form-group">
                <label for="temperature-category">Temperature > 38°C (100.4°F)?</label>
                <select name="temperature-category" class="form-control" id="temperature-category">
                    <option value="0">No</option>
                    <option value="1">Yes</option>
                </select>
            </div>
            <div class="form-group">
                <label for="fever-category">Fever in last 24 hours?</label>
                <select name="fever-category" class="form-control" id="fever-category">
                    <option value="0">No</option>
                    <option value="1">Yes</option>
                </select>
            </div>
            <div class="form-group">
                <label for="symptoms-category">Duration - Rapid onset less than 3 days</label>
                <select name="symptoms-category" class="form-control" id="symptoms-category">
                    <option value="0">No</option>
                    <option value="1">Yes</option>
                </select>
            </div>
            <div class="form-group">
                <label for="headache-category">Headache?</label>
                <select name="headache-category" class="form-control" id="headache-category">
                    <option value="1">No</option>
                    <option value="0">Yes</option>
                </select>
            </div>
            <div class="form-group">
                <label for="sneezing-category">Sneezing?</label>
                <select name="sneezing-category" class="form-control" id="sneezing-category">
                    <option value="0">No</option>
                    <option value="1">Yes</option>
                </select>
            </div>
            <div class="form-group">
                <label for="lymph-nodes-category">Swollen or <em>tender cervical lymph nodes</em>?</label>
                <select name="lymph-nodes-category" class="form-control" id="lymph-nodes-category">
                    <option value="0">No</option>
                    <option value="1">Yes</option>
                </select>
            </div>
            <div class="form-group">
                <label for="swelling-tonsils-category">Swollen tonsils?</label>
                <select name="swelling-tonsils-category" class="form-control" id="swelling-tonsils-category">
                    <option value="0">No</option>
                    <option value="1">Yes</option>
                </select>
            </div>
            <div class="form-group">
                <label for="purulance-category">Tonsilar purulance?</label>
                <select name="purulance-category" class="form-control" id="purulance-category">
                    <option value="0">No</option>
                    <option value="1">Yes</option>
                </select>
            </div>
            <div class="form-group">
                <label for="inflam-category">Inflammed tonsils?</label>
                <select name="inflam-category" class="form-control" id="inflam-category">
                    <option value="0">No</option>
                    <option value="1">Yes</option>
                </select>
            </div>
            <div class="form-group text-center">
                <button type="button" class="btn btn-primary" onclick="showValues()">Analyze</button>
            </div>
            <div class="alert alert-success" role="alert">
                <span id="results">Result will be displayed here once you click on <strong>Analyze</strong>
                    button</span>
                <h3 id="final-status"></h3>
            </div>
            <div class="form-group" id='submit-button' style="visibility:hidden">
                <div class="form-group">
                    <label for="true_value">What is your assesment?</label>
                    <select name="true_value" class="form-control" id="true_value">
                        <option value="Viral">VIRAL</option>
                        <option value="Bacterial">BACTERIAL</option>
                    </select>
                </div>
                <div class="form-group">
                    <button type="submit" class="btn btn-primary">Submit</button>
                </div>
            </div>
        </div>
    </form>

</body>
<script>
    function showValues() {
        var age = parseInt(document.forms["assessment-form"]["age-group-select"].value);
        var cough = parseInt(document.forms["assessment-form"]["cough-category"].value);
        var nose = parseInt(document.forms["assessment-form"]["stuffy-nose-category"].value);
        var temp = parseInt(document.forms["assessment-form"]["temperature-category"].value);
        var fever = parseInt(document.forms["assessment-form"]["fever-category"].value);
        var symptoms = parseInt(document.forms["assessment-form"]["symptoms-category"].value);
        var headache = parseInt(document.forms["assessment-form"]["headache-category"].value);
        var sneeze = parseInt(document.forms["assessment-form"]["sneezing-category"].value);
        var nodes = parseInt(document.forms["assessment-form"]["lymph-nodes-category"].value);
        var swelling_tonsils = parseInt(document.forms["assessment-form"]["swelling-tonsils-category"].value);
        var purulance = parseInt(document.forms["assessment-form"]["purulance-category"].value);
        var inflam = parseInt(document.forms["assessment-form"]["inflam-category"].value);

        var fever_pain_score = fever + purulance + symptoms + inflam + cough;
        var modified_centor = age + cough + temp + nodes + swelling_tonsils;

        // inflam has opposite values for mistik score and fever pain score
        // fever pain score -> Yes : +1, No : 0
        // mistik score -> Yes : 0, No:  +1
        // TODO: Check following operator again
        inflam = inflam ? 0 : 1
        var mistik_score = nose + temp + headache + sneeze + inflam;

        var status = "VIRAL";
        // if modified_centor >= 3 i.e, [3, 4, 5]
        if (modified_centor >= 3 & nodes & swelling_tonsils & temp) {
            status = "BACTERIAL";
        }

        inflam = inflam ? 0 : 1
        if (fever_pain_score >= 4 & inflam & purulance & symptoms) {
            status = "BACTERIAL";
        }

        var results_block = document.getElementById("results");
        var final_status = document.getElementById("final-status");
        var submit_button = document.getElementById("submit-button");

        submit_button.style.visibility = 'visible';

        output_text = ("Results:" + '\n' +
            "Fever pain score is " + fever_pain_score + '\n' +
            "Mistik score is " + mistik_score + '\n' +
            "Modified centor score is " + modified_centor + '\n' +
            "Status is:" + '\n');
        results_block.innerText = output_text;
        final_status.innerText = status;


        // console.log("Hi");
        // alert("Fever pain score is " + fever_pain_score + '\n' +
        // "Mistik score is " + mistik_score + '\n' +
        // "Modified centor score is " + modified_centor + '\n' +
        // "Status is " + status);
        // var txt = document.getElementById("output-txt");
        // txt.innerHTML = "updated";
        // txt.innerHTML = "updated";
    }

</script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

</html>
